%
\chapter{評価実験}
%
\section{データセット}
今回の実験での訓練データセットでは，
Boididouらの研究\cite{boididou2015verifying}によって提案されたTwitter投稿データセットを使用した．
こちらもTwitter上でフェイクニュースを検出するために作られたデータセットであるが，
付加されたラベルとしてReal, Fake, そしてHumorがあり，
ジョークニュースを含めた3カテゴリ分類に適したものとなっているため，当研究で採用した．
データセットでは訓練用と検証用として2部に分かれていたが，
当研究では訓練用とされた部分を対象に10分割交差検定することにした．
データセット内ではツイート文章と画像のみならず，
タイムスタンプや投稿者といったソーシャルコンテキスト情報も含まれている．
当研究ではソーシャルコンテキストは対象に含まず，文章と画像のみで3カテゴリ分類することを目指した．
% 
\section{比較対象手法}
今回，画像つき文章投稿を3カテゴリに分類する提案手法の有効性を調べるために2種類の比較対象手法を用意した．
1つは文章のみで投稿を分類する手法(以降，Textと表記)，もう1つは画像のみで投稿を分類する手法(以降，Imageと表記)であった．
いずれも上記提案モデルから文章・画像特徴生成器を除外したモデルを使用した．
またTextは入力データを提案モデルが使用したデータセットから画像を削除したものを使用した．
Imageは全投稿で使用された画像を対象とし，同じ画像に対して複数の文章投稿があった場合は1件として数えることにした．
% 
\section{実験条件}
\subsection{使用データ統計}
上記の条件を踏まえ，提案手法・Text・Imageが扱う3カテゴリの投稿件数は以下の表\ref{table:posts}の通りである．
Textが使用するデータは提案手法が扱うデータから画像を削除したものであるため，提案手法と全く同じ件数になった．
Imageは，同じ画像に対して複数の投稿があったため，他2手法と比べて非常に少なくなっている．

\begin{table}[h]
    \caption{提案手法と比較対象手法が扱うカテゴリ毎の投稿数}
    \label{table:posts}
    \centering
    \begin{tabular}{clll}
        \hline
        手法 & Real & Fake & Humor \\
        \hline \hline
        Text & 3021 & 4233 & 1509 \\
        Image & 172 & 157 & 82 \\
        提案手法 & 3021 & 4233 & 1509 \\
        \hline
    \end{tabular}
\end{table}

%
\subsection{モデル条件}
\subsubsection{Text}
まず単語埋め込みに変換する際，Google Newsデータセットから事前学習済みのword2vecモデル\cite{google_2013}を使用した．
このモデルでは，各単語を300次元のベクトルに変換するものであった．
ここでwod2vecモデルに該当しない単語が出現した場合，\texttt{<unknown>}としてseed値固定ランダムベクトルを生成することにした．
また，投稿の全単語中50\%以上が\texttt{<unknown>}の場合，実態に則さない学習を避けるために学習対象から外すことにした．
その後テキストCNNに送られ，1つの文章に対して1つの300次元のベクトルが生成され，ニュース分類器に渡す形となった．
なお，フィルタサイズは2-5までとし，隠れ層は1つ用意し，ユニット数は300とした．
隠れ層では60\%のユニットが無視されるDropoutを導入した．
ニュース分類器内でも隠れ層は1つ用意し，ユニット数は300，上記と同じ条件のDropoutも導入した．
%
\subsubsection{Image}
モデルの複雑化を避けるため，1つの投稿に複数枚画像が付加されていた場合は最初の1枚のみをモデルに入力させることにした．
画像は事前学習済みVGG-19モデルに入力し，1つの画像に対して1つの300次元のベクトルが生成され，ニュース分類器に渡す形となった．
本来のVGG-19は最終層にて1000次元のベクトルが出力されるが，最終層のみ改変して300次元のベクトルが出力されるようにした．
また前記の通り過学習を避けるために最終層を除き事前学習済みの状態を維持させることにした．
ニュース分類器の条件は上記Textと同一であった．
%
\subsubsection{提案手法}
提案手法では，TextとImageを統合した形をとったため，画像・文章の部分は上記と同様の条件をとった．
画像・文章の特徴を結合するため，ニュース分類器に渡されるのは600次元のベクトルであった．
それにあわせ，隠れ層のユニット数も600とした．
%
\subsection{評価指標}
評価指標では，Precision(精度), Recall(再現率), F値(左2値の調和平均)を使用することにした．
算出する方法上各カテゴリ毎に上記指標があるが，今回使用するデータセットでは極端にカテゴリが偏っていないので，
各カテゴリの指標を先に算出してから3カテゴリの平均をとるマクロ平均を評価に使うことにした．

\section{実験結果}
3モデルに対して10分割交差検定を行った結果が以下の表\ref{table:result}の通りである．
% 
\begin{table}[h]
    \caption{各モデルの分類成果(マクロ平均)}
    \label{table:result}
    \centering
    \begin{tabular}{clll}
        \hline
        手法 & Precision & Recall & F値 \\
        \hline \hline
        Text & 0.3649 & 0.3677 & 0.3016 \\
        Image & 0.4942 & 0.5055 & 0.4667 \\
        提案手法 & 0.9268 & 0.9362 & 0.9286 \\
        \hline
    \end{tabular}
\end{table}

この結果を見ると，提案手法が他2手法と比べて非常に高い分類成果を挙げたことが読み取れた．
また，比較対象手法内で比べると画像単体の方が分類成果が良好である点もみられた．
